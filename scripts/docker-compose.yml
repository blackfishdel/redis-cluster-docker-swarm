version: '3.2'

services:

  redis-sentinel1:
    image: registry.int.mimikko.cn/redis-sentinel:${TAG:-latest}
    labels:
      - "staging=appredis"
    environment:
      - "REDIS_IP=redis-zero"
      - "REDIS_MASTER_NAME=redismaster"
    deploy:
      replicas: 1
    networks:
      - "mimikko-network"

  redis-sentinel2:
    image: registry.int.mimikko.cn/redis-sentinel:${TAG:-latest}
    labels:
      - "staging=appredis"
    environment:
      - "REDIS_IP=redis-zero"
      - "REDIS_MASTER_NAME=redismaster"
    deploy:
      replicas: 1
    networks:
      - "mimikko-network"

  redis-sentinel3:
    image: registry.int.mimikko.cn/redis-sentinel:${TAG:-latest}
    labels:
      - "staging=appredis"
    environment:
      - "REDIS_IP=redis-zero"
      - "REDIS_MASTER_NAME=redismaster"
    deploy:
      replicas: 1
    networks:
      - "mimikko-network"

  redis1:
    image: registry.int.mimikko.cn/redis-look:${TAG:-latest}
    labels:
      - "staging=appredis"
    environment:
      - "REDIS_SENTINEL_IP=redis-sentinel1"
      - "REDIS_MASTER_NAME=redismaster"
      - "REDIS_SENTINEL_PORT=26379"
    deploy:
      replicas: 1
    networks:
      - "mimikko-network"

  redis2:
    image: registry.int.mimikko.cn/redis-look:${TAG:-latest}
    labels:
      - "staging=appredis"
    environment:
      - "REDIS_SENTINEL_IP=redis-sentinel1"
      - "REDIS_MASTER_NAME=redismaster"
      - "REDIS_SENTINEL_PORT=26379"
    deploy:
      replicas: 1
    networks:
      - "mimikko-network"

  redis3:
    image: registry.int.mimikko.cn/redis-look:${TAG:-latest}
    labels:
      - "staging=appredis"
    environment:
      - "REDIS_SENTINEL_IP=redis-sentinel1"
      - "REDIS_MASTER_NAME=redismaster"
      - "REDIS_SENTINEL_PORT=26379"
    deploy:
      replicas: 1
    networks:
      - "mimikko-network"

networks:
  mimikko-network:
    external: true
